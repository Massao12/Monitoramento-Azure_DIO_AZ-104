# Monitoramento-Azure_DIO_AZ-104
Projeto de monitoramento - DIO - AZ-104 (Azure Administrator)


*************************************EXERCICIO*******************************************

MONITORAR VM
CRIAR O RESOURCE GROUP > CREATE > NOME DO RESOURCE GROUP (MONITORING_VM_DIO_AZ-104) > TAGS
(NAME C.CUSTO AND VALUE 1000) > CREATE

CRIAR VM
VM > CREATE > VIRTUAL MACHINE > INDIQUE O RG CRIADO > NOME DA VM (MONITORING_VM_DIO_AZ-104) > 
REGIÃO > SEM REDUNDANCIA > SECURITY TYPE (STANDARD) > SO > SKU (DEFINA A FAMILIA) > LOGIN E SENHA >
PORTA HTTPS HABILITADA > INSIRA O DISCO (VARIANDO ENTRE STANDARD, PREIUM SSD, STANDARD HDD >
DEFINA SE TERÁ REDUNDÂNCIA > NETWORKING (PADRÃO, SEM ALTERAÇÃO PARA ESTE EXERCICIO) > MANAGEMENT >
MONITORAMENTO (DESABILITA O BOOT DIAGNOSTICS E CRIEI UM TEMPLATE COM O ALERT RULES MANTENDO O
PADRÃO) + HABILITADO HEALTH PARA PROTOCOLO HTTPS, PORTA 443 + SAVE > 
ADVANCED > DEFINA AS TAGS (MESMO USADA NO RG) > REVIEW + CREATE 

OU 

CASO TENHA UM TEMPLATE PRONTO, SEGUE OS PASSOS ABAIXO
DEPLOY A CUSTOM TEMPLATE (PARA FAZER O LOAD DO ARQUIVO JSON DA INFRA PRONTO)
SELECIONA O RESOURCE GROUP > REGIÃO > LOGIN E SENHA > RENEW + CREATE
 
CLIQUE EM RESOURCE GROUP E PROCURE PELO NOME CRIADO, VERIFICANDO COMO POR EXEMPLO,
VM, VNET, STORAGE ACCOUNT, NSG, NIC E IP

CONFIGURAÇÃO DO AZURE MONITOR PARA VM
MONITOR > VM INSIGHTS > VIEW > CONFIGURE INSIGHTS > IDENTIFICAR A VM > ENABLE > DATA COLLECTION 
RULE (VERIFIQUE SE ESTÁ DE ACORDO COM AS PREMISSAS DO PROJETO) > CONFIGURE  

CRIANDO ALERTAS
MONITOR > ALERTS > CREATE > ALERT RULE > SELECIONE O RG + APPLY > CONDITION > SEE ALL SIGNALS >
DELETE VIRTUAL MACHINE > APPLY > ALERT LOGIC > EVENT LEVEL, INITIATED AND STATUS MANTER O MESMO >
ACTIONS > CREATE ACTION GROUP (SELECIONEI O RG) + ACTION GROUP NAME (MONITORAMENTO) + DISPLAY NA-
ME (VM) > NOTIFICATIONS *EMAIL/SMS MESSAGE/PUSH/VOICE* APONTEI PARA O MEU E-MAIL PESSOAL > NAME
FERNANDO + ATIVEI O ENABLE THE COMMON ALERT SCHEMA > ACTION TYPE (MANTIVE O PADRÃO) > 
DETAILS (ALERT RULE NAME: IT CLOUD ADMINISTRATORS) > TAGS (NAME:C.CUSTO) + (VALUE:1000) > 
REVIEW + CREATE > CREATE

PARA VALIDAÇÃO, IR ATÉ A VM, DELETAR E ACOMPANHAR OS E-MAILS, ONDE GERARAM UM BOM RESULTADO COM 
SNAPSHOT EM ANEXO.

*************************************TEORIA************************************

ADMINISTRAR MONITORAMENTO

RECURSOS E COMPONENTES AZURE MONITOR
INSIGHTS E FEATURES (APPLICATION, CONTEINER, VM E REDE)
PROPRIO PORTAL TEM TODAS ESSAS FERRAMENTAS
PODENDO SER USADO FERRAMENTAS EXTERNAS (ZABBIX, GRAFANA)
MONITORA OS PRINCIPAIS SERVIÇOS DO AZURE
COLETA METRICA, LOGS DE ATIVIDADES E DIAGNOSTICO
USA ALEERTAS E NOTIFICAÇÃO COM PRAZO CRITICO

APPLICATION INSIGHTS
MONITORA A DISPONIBILIDADE, DESEMPENHO, ERROS E USO DO APLICATIVO

INSIGHTS DO CONTEINER
TENHA VISIBILIDADE DO DESEMPENHO E INTEGRIDADE DOS CONTROLADORES, NÓS E CONTEINERES

INSIGHTS DA VM
MONITORA INTEGRIDADE, DESEMPENHO, DEPENDENCIAS DA VM E CONJUNTO DE DIMENSIONAMENTO

INSIGHTS DE REDE
EXIBI A INTEGRIDADE E MÉTRICAS DE TODOS OS RESOURCES DE REDE IMPLANTADA

AZURE MONITOR TEM
APLICATIVO, INFRA, PLATAFORMA E FONTES
	FONTES DE DADOS

CONTEM METRICAS, LOGS, RASTREAMENTOS E ALTERAÇÕES
	PLATAFORMA DE DADOS

PRINCIPAIS INSIGHTS
APLICATIVO, CONTEINER,VM E REDE

VISUALIZAÇÃO
PASTA DE TRABALHO, PAINEL, POWERBI E GRAFANA

ANALISE
METRICS EXPLORER, LOG ANALYTICS, ANALISE DE ALTERAÇÕES

RESPONDER
ALERTAS E AÇÕES E DIMENSIONAMENTO

INTEGRAÇÃO
HUB DE EVENTOS, APP LOGIC E INPORTAR/EXPORTAR APIS

COMPONENTES DO MONITOR
DADOS DE MONITORAMENTO DE APP
SO CONVIDADO
RESOURCES DO AZURE
SUBSCRIPTION 
TENANT

DIFERENÇA ENTRE MÉTRICA E LOGS
MÉTRICA
VALORES NUMERICOS ONDE DESCREVE ASPECTOS DE UM SISTEMA EM UM MOMENTO
SÃO LEVES E PODEM DAR SUPORTE A CENARIOS EM TEMPO REAL
95% EM DISCO EM X MINUTOS (DADOS)
MINHA VM ESTÁ DESLIGADA A X MINUTOS 


LOGS
CONTEM DIFERENTES TIPOS DE DADOS ORGANIZADOS EM REGISTROS COM DIFERENTES PROPRIEDADES PARA CADA 
TELEMETRIA (EVENTOS E RASTREAMENTO)
DADOS DE DESEMPENHO
É UMA INFORMAÇÃO
X USER LOGOU EM TAL HORÁRIO
X NÃO CONSEGUE CONECTAR EM Y RESOURCE

EVENTOS DE LOG DE ATIVIDADES EM COMPUTAÇÃO
LOG DE APLICATIVO
LOG DE DIAGNOSTICO
	FOCADO EM APLICATIVO
SO CONVIDADO

LOG DE ATIVIDADE - INFRA DO AZURE

RECURSO (RESOURCES DE COMPUTAÇÃO)
LOG DE DIAGNOSTICO - LOG DE APLICATIVO
LOG DE DIAGNOSTICO
	FOCADO EM APLICATIVO
SO CONVIDADO

LOG DE ATIVIDADES - INFRA DO AZURE

EVENTOS DE LOG DE ATIVIDADES
ENVIAR DADOS AO LOG ANALITYCS PARA PESQUISA AVANÇADA E ALERTAS
CONSULTAR OU GERENCIAR EVENTOS NO PORTAL, POWERSHELL, CLI E API REST
TRANSMITIR INFOS PARA HUB DE EVENTOS (ENVIA AS INFOS PARA UM DESTINO COMO RESOURCE OU APP DE 3°) 
ARQUIVAR DADOS EM UMA STORAGE ACCOUNT
ANALISE DE DADOS COM BI

DENTRO DA LOG DE ATIVIDADE CONSIGO
FILTRAR POR GRUPO DE GERENCIAMENTO, ASSINATURA, INTERVALO DE TEMPO E SEVERIDADE DO EVENTO
ADICIONAR UM FILTRO POR CAMADA (SEGURANÇA, RECOMENDAÇÕES, ALERTAS)
FIXAR FILTROS ATUAIS E FAZER DOWNLOAD VIA CSV

EXPLORANDO O AZURE MONITOR NA PRATICA

TEM O PROMETHEUS, GRAFANA E SCOM (FERRAMENTAS DE MERCADO)

O WORKSPACE É UM REPOSITÓRIO ONDE ARMAZENA AS INFORMAÇÕES E CONSIGO COLETAR OS DADOS QUE PRECISO
 
SERVICE HEALTH - MOSTRA INDISPONIBILIDADE EM UM AMBIENTE MS.

METRICA= %
LOGS = INFORMAÇÕES
SEMPRE HABILITAR OS SERVICES 

CONFIGURANDO ALERTAS DO AZURE
UM ALERTA É CRIADO E VAI DIRETO PARA UM ESPECIE DE BD NOS RESOURCES DO AZURE (AZURE MONITOR)
ONDE EMITE UMA TELEMETRIA PARA APURAR SE ESTÁ TUDO CERTO E BASEADO NAS REGRAS CONFIGURADAS.
TUDO QUE É COLETADO, ELE PRECISA SER ANALISADO E AVALIADO (ALTO USO DE MEMÓRIA, ARMAZENAMENTO,
PROCESSADOR, ETC)  
OU SEJA
O QUE EU PRECISO MONITORAR? QUAIS SERIAM AS CONDIÇÕES DEFINIDAS?
EX: TENHO UM ARMAZENAMENTO, E QUANDO CHEGAR A 80% DE USO, QUERO QUE DISPARE UM ALERTA VIA DASHBO-
ARD PARA O AZURE MONITOR. IDEAL TAMBÉM SINALIZAR POR CATEGORIAS, POR EXEMPLO, CHEGOU EM 90% GERA
UM OUTRO ALERTA MAIS INCISSIVO.
QUANDO O ALERTA ACONTECE, É FEITO UM PROCESSAMENTO PARA INDICAR O OCORRIDO E GERA UMA NOTIFICAÇÃO,
PODENDO VARIAR ENTRE SMS, DASHBOARD, TEAMS, ETC.

CRIAR REGRAS DE ALERTA

EM CONDIÇÃO, SEGUE ABAIXO:

CASO TIVER MAIS DE 1 LINHA, A SEVERIDADE FICA COMO DETALHADO (ALTO IMPACTO NEGATIVO). ALÉM DISSO
TEMOS O ESCOPO DO DESTINO, TIPO DE RESOURCE, SINAL E STATUS ATUAL

AS REGRAS DE ALERTAS COMBINAM COM OS RESOURCES QUE SERÁ MONITORADO, POR MEIO DE SINAL, DADOS E 
CONDIÇÕES. ALÉM DISSO, PODE HABILITAR REGRAS PRONTA PARA USO QUE SE ENCONTRA NO PORTAL DO AZURE

PARA DEMAIS CASOS, COMO REGRA CUSTOMIZADA, SERÁ NECESSÁRIO FAZER NA MÃO. 

GRUPOS DE AÇÃO
AQUELE CASO ONDE É GERADO A NOTIFICAÇÃO, PODENDO VARIAR ENTRE EMAIL, SMS, PUSH OU SERVIÇO DE VOZ,
OU ENVIAR E-MAIL PARA UMA FUNÇÃO DO ARM.

POSSO CRIAR ATÉ 5 GRUPOS DE AÇÕES COM UMA REGRA DE ALERTA, ONDE POSSO USAR A MESMA REGRA NO MESMO
GRUPO DE AÇÃO.

TIPO DE AÇÃO VARIAM ENTRE LOGIC APP, AZURE FUNCTIONS, HUB DE EVENTOS, ITSM, RUNBOOK DE AUTOMAÇÃO,
WEBHOOK E WEBHOOK SEGURO E NO SELECIONADO, ADICIONO PARA QUEM ENVIAR 

LOG ANALYTICS
REUNIÃO DE INFORMAÇÕES QUE PODEM DISPARAR ALARME DE ACORDO COM AS REGRAS
AQUI É FEITO A VALIDAÇÃO DAS REGRAS E ALARMES

AJUDA A VOCÊ A COLETAR E ANALISAR DADOS GERADOS PELOS RESOURCES EM SEU AMBIENTE ON-PREMISE OU NUVEM
ALI, PODEMOS AVALIAR UPDATES DO SISTEMA E SOLUCIONAR PROBLEMAS DE INCIDENTES OPERACIONAIS
ALEM DE ESCREVER CONSULTAS DE LOG E ANALISE DOS RESULTADOS

TODA ESSA CONSULTA POSSO DIRECIONAR PARA UM IP, USER. PORÉM PARA ESSE AMBIENTE FUNCIONAR, É NECES-
SARIO CRIAR UM WORKSPACE, ONDE É INSERIDO OS DADOS, INFORMAÇÕES E AVALIA O STATUS. 
ELE É UM CONTEINER ONDE FICA ALOCADO OS DADOS. ALÉM DISSO, FORNECE A LOCALIZAÇÃO GEOGRAFICA, ISO-
LAMENTO DE DADOS E ESCOPO, PODENDO TER VARIAS WORKSPACES POR SUBCRIPTION E TER ACESSO A TODAS.

APÓS TODO ESSE PROCESSO, É FEITO A ANALISE DE LOGS DE ACORDO COM AS INFORMAÇÕES GERADAS, ONDE 
POSSO ANALISAR AS REGRAS, ALERTAS E EFEITOS EM UM RESOURCE, OU FAZER CONSULTA PARA DETERMINAR QUAL
SERÁ O MEU PLANO DE AÇÃO.

EXISTE A KQL, QUE É UMA CONSULTA COMUM EM UMA LINGUAGEM PARA PESQUISAS PERSONALIZADAS, ALÉM 
DE RECUPERAR E CONSOLIDAR DADOS NO REPOSITÓRIO. POSSO EXPORTAR OS DADOS PARA O POWER BI OU EXCEL,
FAZER OU SALVAR QUE AS PESQUISAS DE LOG SEJA EXECUTADA DE FORMA AUTOMATICA PARA CRIAR UM ALERTA,

SYSLOG É ONDE É REALIZADO A CONSULTA DO LOG ANALITYCS DO LINUX

PARA WINDOWS, É EVENT
PARA AGENTES, É HEARTBEAT
PARA LOGS PERSONALIZADOS, MYLOG_CL
PARA REGRA DE ALERTAS, UM ALERT  




    
